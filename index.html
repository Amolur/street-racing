<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Street Racing - Гоночная игра</title>
    <link rel="stylesheet" href="racing-mobile-ui.css">
    <meta name="theme-color" content="#ff4444">
    <meta name="description" content="Street Racing - захватывающая мобильная гоночная игра">
    
    <!-- PWA манифест -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Иконки -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16x16.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
</head>
<body>
    <!-- Главный контейнер -->
    <div class="mobile-container">
        
        <!-- ================================ -->
        <!-- ЭКРАН АВТОРИЗАЦИИ -->
        <!-- ================================ -->
        <div id="auth-screen" class="mobile-screen active">
            <div class="mobile-header">
                <div class="header-logo-section" onclick="window.location.reload()">
                    <img src="logo.png" alt="Street Racing" class="full-width-logo" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div class="text-logo-fallback" style="display: none;">Street Racing</div>
                </div>
            </div>
            
            <div class="mobile-main">
                <div class="screen-content" style="justify-content: center;">
                    
                    <!-- Формы авторизации -->
                    <div class="auth-container">
                        
                        <!-- Форма входа -->
                        <div id="login-form" class="auth-form active">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Вход в игру</h2>
                                </div>
                                <div class="card-body">
                                    <form onsubmit="window.handleLogin(); return false;">
                                        <div class="form-group">
                                            <label class="form-label">Логин</label>
                                            <input type="text" id="login-username" class="form-input" 
                                                   placeholder="Введите логин" autocomplete="username" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="form-label">Пароль</label>
                                            <input type="password" id="login-password" class="form-input" 
                                                   placeholder="Введите пароль" autocomplete="current-password" required>
                                        </div>
                                        
                                        <button type="submit" class="action-button">
                                            Войти в игру
                                        </button>
                                    </form>
                                    
                                    <div style="text-align: center; margin-top: 20px;">
                                        <p style="color: var(--race-text-secondary); font-size: 14px;">
                                            Нет аккаунта?
                                        </p>
                                        <button type="button" class="action-button secondary" 
                                                onclick="window.showRegisterForm()" style="margin-top: 10px;">
                                            Создать аккаунт
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Форма регистрации -->
                        <div id="register-form" class="auth-form">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Регистрация</h2>
                                </div>
                                <div class="card-body">
                                    <form onsubmit="window.handleRegister(); return false;">
                                        <div class="form-group">
                                            <label class="form-label">Логин</label>
                                            <input type="text" id="register-username" class="form-input" 
                                                   placeholder="Придумайте логин" autocomplete="username" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="form-label">Пароль</label>
                                            <input type="password" id="register-password" class="form-input" 
                                                   placeholder="Придумайте пароль" autocomplete="new-password" required>
                                        </div>
                                        
                                        <div class="form-group">
                                            <label class="form-label">Подтвердите пароль</label>
                                            <input type="password" id="register-password-confirm" class="form-input" 
                                                   placeholder="Повторите пароль" autocomplete="new-password" required>
                                        </div>
                                        
                                        <button type="submit" class="action-button">
                                            Создать аккаунт
                                        </button>
                                    </form>
                                    
                                    <div style="text-align: center; margin-top: 20px;">
                                        <p style="color: var(--race-text-secondary); font-size: 14px;">
                                            Уже есть аккаунт?
                                        </p>
                                        <button type="button" class="action-button secondary" 
                                                onclick="window.showLoginForm()" style="margin-top: 10px;">
                                            Войти
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
        </div>
        
        <!-- ================================ -->
        <!-- ОСНОВНАЯ ИГРА -->
        <!-- ================================ -->
        <div id="game-container" class="mobile-screen">
            
            <!-- Верхняя панель -->
            <div class="mobile-header">
                <div class="header-logo-section" onclick="window.showMainMenu()">
                    <img src="logo.png" alt="Street Racing" class="full-width-logo" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div class="text-logo-fallback" style="display: none;">Street Racing</div>
                </div>
                
                <!-- Панель ресурсов игрока -->
                <div class="player-info-bar">
                    <div class="info-bar-content">
                        <div class="resource-item">
                            <div class="resource-icon level">Lv</div>
                            <span id="header-level">1</span>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon money">$</div>
                            <span id="header-money">0</span>
                        </div>
                        
                        <div class="resource-item">
                            <div class="resource-icon fuel">⛽</div>
                            <span id="header-fuel">30</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Основной контент игры -->
            <div class="mobile-main">
                
                <!-- ================================ -->
                <!-- ГЛАВНОЕ МЕНЮ -->
                <!-- ================================ -->
                <div id="main-menu" class="mobile-screen active">
                    <div class="main-menu-container">
                        
                        <div class="welcome-message">
                            <h2>Добро пожаловать, <span id="player-name">Гонщик</span>!</h2>
                        </div>
                        
                        <div class="menu-grid">
                            <button class="menu-button race" onclick="window.showRaceMenu()">
                                <div>
                                    <div class="menu-button-title">🏁 Гонки</div>
                                    <div class="menu-button-subtitle">Соревнуйтесь с соперниками</div>
                                </div>
                            </button>
                            
                            <button class="menu-button garage" onclick="window.showGarage()">
                                <div>
                                    <div class="menu-button-title">🚗 Гараж</div>
                                    <div class="menu-button-subtitle">Машин: <span id="player-cars">1</span></div>
                                </div>
                            </button>
                            
                            <button class="menu-button shop" onclick="window.showShop()">
                                <div>
                                    <div class="menu-button-title">🛒 Магазин</div>
                                    <div class="menu-button-subtitle">Покупка машин и деталей</div>
                                </div>
                            </button>
                            
                            <button class="menu-button tasks" onclick="window.showDailyTasks()">
                                <div>
                                    <div class="menu-button-title">📋 Задания</div>
                                    <div class="menu-button-subtitle">Ежедневные награды</div>
                                </div>
                                <div id="daily-tasks-counter" class="badge" style="display: none;">0</div>
                            </button>
                            
                            <button class="menu-button secondary" onclick="window.showProfile()">
                                <div>
                                    <div class="menu-button-title">👤 Профиль</div>
                                    <div class="menu-button-subtitle">Уровень: <span id="player-level">1</span>, Побед: <span id="player-wins">0</span></div>
                                </div>
                            </button>
                            
                            <button class="menu-button secondary" onclick="window.showCommunity()">
                                <div>
                                    <div class="menu-button-title">💬 Сообщество</div>
                                    <div class="menu-button-subtitle">Чат и новости</div>
                                </div>
                            </button>
                            
                            <button class="menu-button secondary" onclick="window.showLeaderboard()">
                                <div>
                                    <div class="menu-button-title">🏆 Рейтинг</div>
                                    <div class="menu-button-subtitle">Лучшие игроки</div>
                                </div>
                            </button>
                            
                            <button class="menu-button secondary" onclick="window.logout()">
                                <div>
                                    <div class="menu-button-title">🚪 Выход</div>
                                    <div class="menu-button-subtitle">Выйти из игры</div>
                                </div>
                            </button>
                        </div>
                        
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН ГОНОК -->
                <!-- ================================ -->
                <div id="race-menu" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Гонки</span>
                    </div>
                    
                    <div class="screen-content">
                        <!-- Информация о текущей машине -->
                        <div class="info-panel">
                            <div class="info-panel-header">
                                <span class="info-panel-title">Ваша машина</span>
                            </div>
                            <div class="stat-row">
                                <span>Машина:</span>
                                <span id="race-current-car">-</span>
                            </div>
                            <div class="stat-row">
                                <span>Топливо:</span>
                                <span id="race-car-fuel">-</span>
                            </div>
                            <div class="stat-row">
                                <span>Баланс:</span>
                                <span>$<span id="race-balance">0</span></span>
                            </div>
                        </div>
                        
                        <!-- Список соперников -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Соперники</h3>
                            </div>
                            <div class="card-body">
                                <div id="opponents-list">
                                    <div class="loading">Загрузка соперников...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН РЕЗУЛЬТАТА ГОНКИ -->
                <!-- ================================ -->
                <div id="race-result-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.showRaceMenu()">←</button>
                        <span class="screen-title">Результат гонки</span>
                    </div>
                    
                    <div class="screen-content">
                        <div id="race-result">
                            <!-- Результат будет вставлен динамически -->
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН ГАРАЖА -->
                <!-- ================================ -->
                <div id="garage-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Гараж</span>
                    </div>
                    
                    <div class="screen-content">
                        <div id="garage-content">
                            <!-- Содержимое гаража будет вставлено динамически -->
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН МАГАЗИНА -->
                <!-- ================================ -->
                <div id="shop-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Магазин</span>
                    </div>
                    
                    <div class="screen-content">
                        <div class="tabs-container">
                            <div class="tabs-header">
                                <button class="tab-button active" onclick="window.showShopTab('buy')">
                                    Покупка
                                </button>
                                <button class="tab-button" onclick="window.showShopTab('sell')">
                                    Продажа
                                </button>
                            </div>
                            
                            <div id="shop-buy" class="tab-content active">
                                <div id="cars-for-sale">
                                    <!-- Машины для покупки -->
                                </div>
                            </div>
                            
                            <div id="shop-sell" class="tab-content">
                                <div id="cars-to-sell">
                                    <!-- Машины для продажи -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН ЕЖЕДНЕВНЫХ ЗАДАНИЙ -->
                <!-- ================================ -->
                <div id="daily-tasks-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Ежедневные задания</span>
                    </div>
                    
                    <div class="screen-content">
                        <div class="info-panel">
                            <div class="info-panel-header">
                                <span class="info-panel-title">Время до обновления</span>
                                <span id="tasks-timer">--:--:--</span>
                            </div>
                        </div>
                        
                        <div id="daily-tasks-list">
                            <!-- Задания будут вставлены динамически -->
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН ПРОФИЛЯ -->
                <!-- ================================ -->
                <div id="profile-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Профиль</span>
                    </div>
                    
                    <div class="screen-content">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title" id="profile-username">Игрок</h3>
                                <img class="profile-avatar" src="" alt="Аватар" style="width: 50px; height: 50px; border-radius: 50%;">
                            </div>
                            
                            <div class="card-body">
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <div class="stat-label">Уровень</div>
                                        <div class="stat-value" id="profile-level">1</div>
                                    </div>
                                    
                                    <div class="stat-item">
                                        <div class="stat-label">Опыт</div>
                                        <div class="stat-value" id="profile-experience">0</div>
                                    </div>
                                    
                                    <div class="stat-item">
                                        <div class="stat-label">Деньги</div>
                                        <div class="stat-value" id="profile-money">$0</div>
                                    </div>
                                    
                                    <div class="stat-item">
                                        <div class="stat-label">Побед</div>
                                        <div class="stat-value" id="profile-wins">0</div>
                                    </div>
                                    
                                    <div class="stat-item">
                                        <div class="stat-label">Всего гонок</div>
                                        <div class="stat-value" id="profile-total-races">0</div>
                                    </div>
                                    
                                    <div class="stat-item">
                                        <div class="stat-label">Машин</div>
                                        <div class="stat-value" id="profile-cars-count">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Достижения -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Достижения</h3>
                                <span><span id="unlocked-achievements">0</span>/<span id="total-achievements">0</span></span>
                            </div>
                            <div class="card-body">
                                <div id="achievements-list">
                                    <!-- Достижения будут вставлены динамически -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН СООБЩЕСТВА -->
                <!-- ================================ -->
                <div id="community-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Сообщество</span>
                    </div>
                    
                    <div class="screen-content">
                        <div class="tabs-container">
                            <div class="tabs-header">
                                <button class="tab-button active" onclick="window.showChatTab('chat')">
                                    Чат
                                </button>
                                <button class="tab-button" onclick="window.showChatTab('news')">
                                    Новости
                                </button>
                            </div>
                            
                            <div id="community-chat" class="tab-content active">
                                <div style="height: 300px; overflow-y: auto; border: 1px solid var(--race-border); border-radius: var(--race-radius); margin-bottom: 12px;">
                                    <div id="chat-messages" style="padding: 12px;">
                                        <!-- Сообщения чата -->
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 8px;">
                                    <input type="text" id="chat-input" class="form-input" 
                                           placeholder="Написать сообщение..." style="flex: 1;">
                                    <button class="action-button small" onclick="window.sendChatMessage()">
                                        Отправить
                                    </button>
                                </div>
                            </div>
                            
                            <div id="community-news" class="tab-content">
                                <div id="news-list">
                                    <!-- Новости -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ================================ -->
                <!-- ЭКРАН РЕЙТИНГА -->
                <!-- ================================ -->
                <div id="leaderboard-screen" class="mobile-screen">
                    <div class="screen-header">
                        <button class="back-button" onclick="window.goBack()">←</button>
                        <span class="screen-title">Рейтинг</span>
                    </div>
                    
                    <div class="screen-content">
                        <div id="leaderboard-list">
                            <!-- Рейтинг будет вставлен динамически -->
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
    
    <!-- Индикатор сохранения -->
    <div id="save-indicator" class="save-indicator">
        <span class="save-icon">💾</span>
        <span class="save-text">Сохранение...</span>
    </div>
    
    <!-- Скрипты -->
    <script src="api.js"></script>
    <script type="module" src="modules/notifications.js"></script>
    <script type="module" src="app.js"></script>
    
</body>
</html>